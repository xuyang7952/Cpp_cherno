# **C++ 中创建与使用库**

## 一、核心目标

在大型 C++ 项目中，将通用代码（如引擎、工具类、数学库等）封装成独立的 **库（Library）**，供多个项目复用。这不仅能提高代码模块化程度，还能实现跨项目共享和混合语言开发。

本文以创建一个名为 `Engine` 的静态库，并在 `Game` 可执行项目中使用它为例。

## 二、创建与使用库的步骤

### ✅ 第一步：添加多个项目（Multiple Projects）

1. **创建主项目（如 Game）**
   * 使用 Visual Studio 创建一个常规的 C++ 可执行项目（`.exe`），命名为 `Game`。
   * 确保其配置类型为 **"Application (.exe)"**。
2. **添加库项目（如 Engine）**
   * 在解决方案（Solution）上右键 → **"Add" → "New Project"**。
   * 创建一个新的 **Static Library** 项目，命名为 `Engine`。
   * 注意**Engine文件夹是在Game文件夹里的**
   * 确保其配置类型为 **"Static Library (.lib)"**。
3. **项目结构示例**
   <pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">text</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>Solution (Game.sln)
   </span>├── Game (Executable)
   <span>└── Engine (</span><span>Static</span><span> Library)
   </span>    ├── src/Engine.cpp
   <span>    └── </span><span>include</span><span>/Engine.h</span></code></pre></div></div></pre>

### 第二步：配置头文件包含路径（Include Paths）

为了让 `Game` 项目能正确包含 `Engine` 的头文件，应避免使用**相对路径**（易因文件移动出错），而使用**绝对包含路径**。

#### ❌ 错误方式（相对路径）：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>#</span>include<span> </span>"../../Engine/src/Engine.h"</code></pre></div></div></pre>

> 一旦项目结构调整，路径就会失效。

#### ✅ 正确方式（使用编译器包含目录）：

1. 在 `Game` 项目上右键 → **Properties** → **C/C++** → **General** → **Additional Include Directories**。
2. 添加 `Engine` 项目的头文件目录路径，例如：
   <pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">text</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>$(SolutionDir)Engine\include</span></code></pre></div></div></pre>
3. 之后即可使用简洁的包含方式：
   <pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>#</span>include<span> </span>"Engine.h"</code></pre></div></div></pre>

### 第三步：链接库文件（Linking）

Visual Studio 提供了便捷的项目依赖管理功能，无需手动指定 `.lib` 文件路径。

1. **添加项目引用（Add Reference）**

   * 在 `Game` 项目上右键 → **"Add" → "Reference"**。
   * 勾选 `Engine` 项目，点击 **OK**。
2. **自动链接机制**

   * VS 会自动将 `Engine.lib` 添加到 `Game` 的链接输入中。
   * 构建 `Game` 时，会自动先构建 `Engine`，生成 `Engine.lib`，再链接到 `Game.exe`。
3. **验证构建顺序** 执行 **Clean Solution** 后再构建 `Game`，输出日志应显示：

   <pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">text</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>1></span><span class="bash">------ Build started: Project: Engine, Configuration: Debug x64 ------</span><span>
   </span><span></span><span>1></span><span class="bash">Engine.vcxproj -> ...Engine.lib</span><span>
   </span><span></span><span>2></span><span class="bash">------ Build started: Project: Game, Configuration: Debug x64 ------</span><span>
   </span><span></span><span>2></span><span class="bash">Game.vcxproj -> ...Game.exe</span></code></pre></div></div></pre>

   > 这表明 `Game` 依赖于 `Engine`，构建顺序正确。
   >

---

## 🧩 三、代码使用示例

假设 `Engine.h` 定义了一个简单的函数：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>// Engine.h</span><span>
</span><span></span><span>#</span>pragma<span> once</span><span>
</span><span></span><span>namespace</span><span> engine {
</span><span>    </span>void PrintMessage()<span>;
</span>}</code></pre></div></div></pre>

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>// Engine.cpp</span><span>
</span><span></span><span>#</span>include<span> </span>"Engine.h"<span>
</span><span></span><span>#</span>include<span> </span><iostream><span>
</span>
<span></span><span>namespace</span><span> engine {
</span><span>    </span>void PrintMessage() <span>{
</span><span>        </span><span>std</span><span>::</span><span>cout</span><span> << </span><span>"Hello from Engine!"</span><span> << </span><span>std</span><span>::</span><span>endl</span><span>;
</span>    }
}</code></pre></div></div></pre>

在 `Game` 项目中调用：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>// Application.cpp</span><span>
</span><span></span><span>#</span>include<span> </span>"Engine.h"<span>
</span>
<span></span>int main() <span>{
</span><span>    engine::PrintMessage();  </span><span>// 调用库函数</span><span>
</span><span>    </span><span>return</span><span> </span>0<span>;
</span>}</code></pre></div></div></pre>

## 四、关键优势总结


| 优势             | 说明                                                 |
| ---------------- | ---------------------------------------------------- |
| **模块化**       | 将通用功能封装为独立库，便于维护和升级。             |
| **代码复用**     | 多个项目可共享同一个库，避免重复代码。               |
| **自动构建依赖** | 通过“项目引用”，VS 自动处理构建顺序和链接。        |
| **避免路径问题** | 使用包含目录而非相对路径，提升项目可移植性。         |
| **静态链接**     | 库代码在编译时被嵌入可执行文件，无需额外分发`.dll`。 |

---

## 📝 五、总结

在 Visual Studio 中创建和使用 C++ 库（特别是静态库）的核心流程如下：

1. **创建多项目解决方案**：一个可执行项目（`.exe`）和一个静态库项目（`.lib`）。
2. **配置包含路径**：使用“附加包含目录”让主项目能找到库的头文件。
3. **添加项目引用**：通过“Add Reference”建立依赖关系，实现自动链接。
4. **享受自动构建**：修改库代码后，构建主项目会自动重新编译库并链接。

> 💡 **提示**：这种方法特别适用于游戏引擎、工具库、数学库等需要跨项目复用的场景。掌握此技能是迈向大型 C++ 项目开发的重要一步。

# linux上vscode开发构建

VS Code 本身只是一个**代码编辑器**，它不负责编译或链接。真正的构建工作是由 **CMake、Make、GCC/G++、Xmake 等工具链**完成的。VS Code 通过插件（如 CMake Tools）提供对这些工具的**可视化支持**。


## 正确方式：使用构建系统（推荐 CMake）

### 🔧 核心工具链


| 工具                           | 作用                                                              |
| ------------------------------ | ----------------------------------------------------------------- |
| **GCC/G++**                    | 编译器，用于编译`.cpp` 文件和链接 `.lib`（Linux 上叫 `.a`）静态库 |
| **ar**                         | 打包静态库（生成`.a` 文件）                                       |
| **CMake**                      | 跨平台构建系统生成器，生成`Makefile` 或 `Ninja` 构建脚本          |
| **Make/Ninja**                 | 构建工具，执行编译和链接命令                                      |
| **VS Code + CMake Tools 插件** | 提供代码导航、构建、调试的图形化界面                              |

---

## 📌 实际操作步骤（以 CMake 为例）

假设目录结构如下：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">text</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>project/
</span><span>├── Game/                 </span><span># 可执行项目</span><span>
</span>│   ├── src/main.cpp
│   └── CMakeLists.txt
<span>├── Engine/               </span><span># 静态库项目</span><span>
</span><span>│   ├── </span><span>include</span><span>/Engine.h
</span>│   ├── src/Engine.cpp
│   └── CMakeLists.txt
<span>└── CMakeLists.txt        </span><span># 根 CMakeLists.txt</span></code></pre></div></div></pre>

### 第一步：为 `Engine` 创建静态库

**`Engine/CMakeLists.txt`**

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cmake</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>cmake_minimum_required(VERSION </span>3.14<span>)
</span>project(Engine)

<span></span><span># 创建静态库</span><span>
</span><span>add_library(engine </span><span>STATIC</span><span>
</span>    src/Engine.cpp
)

<span></span><span># 指定头文件搜索路径（供外部使用）</span><span>
</span><span>target_include_directories(engine </span><span>PUBLIC</span><span>
</span><span>    ${CMAKE_CURRENT_SOURCE_DIR}/</span><span>include</span><span>
</span>)</code></pre></div></div></pre>

---

### 第二步：在 `Game` 中使用 `Engine` 库

**`Game/CMakeLists.txt`**

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cmake</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>cmake_minimum_required(VERSION </span>3.14<span>)
</span>project(Game)

<span></span><span># 查找依赖（可选，如果 Engine 安装到系统路径）</span><span>
</span><span></span><span># 这里我们直接添加子目录</span><span>
</span>
<span></span><span># 添加 Engine 库（作为子项目）</span><span>
</span>add_subdirectory(../Engine ../Engine/build)

<span></span><span># 创建可执行文件</span><span>
</span>add_executable(game
    src/main.cpp
)

<span></span><span># 链接 Engine 静态库</span><span>
</span>target_link_libraries(game engine)</code></pre></div></div></pre>

---

### 第三步：根目录 `CMakeLists.txt`（可选）

**`project/CMakeLists.txt`**

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">cmake</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span>cmake_minimum_required(VERSION </span>3.14<span>)
</span>project(MyGame)

<span></span><span># 设置构建输出目录</span><span>
</span><span></span><span>set</span><span>(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/</span><span>bin</span><span>)
</span>
<span></span><span># 包含子项目</span><span>
</span>add_subdirectory(Game)</code></pre></div></div></pre>

---

### 第四步：构建项目

在终端中执行：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[42px] sticky top-0 z-10 bg-capsule"><div class="flex items-center h-[42px] p-3 text-[14px] border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-[rgba(17,17,51,0.7)]">bash</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-sun-line"></use></svg></span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#appicon-copy-line"></use></svg></span></div></div></div><pre><code><span># 进入项目根目录</span><span>
</span><span></span><span>cd</span><span> project
</span>
<span></span><span># 创建构建目录</span><span>
</span><span>mkdir build && </span><span>cd</span><span> build
</span>
<span></span><span># 生成 Makefile</span><span>
</span>cmake ..

<span></span><span># 编译（自动先编译 Engine，再编译 Game）</span><span>
</span>make

<span></span><span># 运行</span><span>
</span>./bin/game</code></pre></div></div></pre>

---

## 🛠️ VS Code 中的使用体验

1. **安装插件**：
   * **CMake Tools**（由 Microsoft 提供）：提供 CMake 配置、构建、调试按钮。
   * **C/C++**：提供智能补全、跳转、调试支持。
2. **操作流程**：
   * 打开 `project/` 目录。
   * CMake Tools 会自动检测 `CMakeLists.txt`。
   * 点击右下角 “No Kit” 选择编译器（如 GCC）。
   * 点击 “Configure All” 生成构建系统。
   * 点击 “Build” 按钮即可编译整个项目。

> ✅ VS Code + CMake Tools 的体验接近 Visual Studio，但底层是基于文本配置的自动化构建。
>


## CMake vs Xmake


| 特性             | **CMake**              | **Xmake**            |
| ---------------- | ---------------------- | -------------------- |
| **流行度**       | ⭐⭐⭐⭐⭐（行业标准） | ⭐⭐⭐（国内较流行） |
| **语法**         | 复杂，但功能强大       | 更简洁，类似 Lua     |
| **跨平台**       | 极佳                   | 极佳                 |
| **VS Code 支持** | 官方插件，支持好       | 有插件，但生态较小   |
| **学习成本**     | 较高                   | 较低                 |

> ✅ **推荐选择 CMake**，尤其是在 Linux 服务器上，它是事实上的标准。

---

## ✅ 总结：VS Code + Linux 上使用静态库的正确方式


| 问题                           | 解答                                                           |
| ------------------------------ | -------------------------------------------------------------- |
| **用什么替代 VS 的“引用”？** | **CMake 的 `add_subdirectory` + `target_link_libraries`**      |
| **VS Code 起什么作用？**       | 编辑代码 + 通过插件调用 CMake/GCC                              |
| **静态库文件是什么？**         | `.a` 文件（如 `libengine.a`），由 `ar` 命令生成                |
| **如何链接？**                 | 在`CMakeLists.txt` 中使用 `target_link_libraries(game engine)` |
| **推荐工具链？**               | **GCC + CMake + Make + VS Code + CMake Tools 插件**            |

---

### 💡 一句话总结：

> 在 Linux 上用 VS Code 开发 C++，**不要依赖图形化“引用”**，而是使用 **CMake 管理项目依赖和构建流程**，VS Code 只是你的“智能记事本”，真正的构建由 CMake 和 GCC 完成。
