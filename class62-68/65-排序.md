# C++ 排序（Sorting in C++）说明与总结


## 一、C++ 排序的核心工具：`std::sort`

C++ 标准库提供了强大且高效的排序函数：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><algorithm></span><span>
</span><span>std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>first</span><span class="token">,</span><span> last</span><span class="token">,</span><span> </span><span class="token">[</span><span>comp</span><span class="token">]</span><span class="token">)</span><span class="token">;</span></code></pre></div></div></pre>

* **时间复杂度**：平均和最坏情况下为 **O(n log n)**（通常基于 introsort：快排 + 堆排 + 插入排序混合）
* **非稳定排序**：相等元素的相对顺序可能改变（如需稳定排序，用 `std::stable_sort`）
* **要求迭代器为随机访问迭代器**（如 `std::vector`, `std::array`, 原生数组）


## 二、三种常用排序方式


| 方式                  | 说明                                                         |
| --------------------- | ------------------------------------------------------------ |
| **1. 默认升序**       | 对内置类型（如`int`, `double`, `string`）自动按 `<` 升序排列 |
| **2. 使用标准谓词**   | 如`std::greater<int>()` 实现降序                             |
| **3. 自定义比较函数** | 通过**lambda 表达式** 或 **函数对象** 定义任意排序规则       |



## 三、关键概念：比较函数（Comparator / Predicate）

`std::sort` 的第三个参数是一个**可调用对象**，必须满足：

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token">bool</span><span> </span><span class="token">comp</span><span class="token">(</span><span class="token">const</span><span> T</span><span class="token">&</span><span> a</span><span class="token">,</span><span> </span><span class="token">const</span><span> T</span><span class="token">&</span><span> b</span><span class="token">)</span><span class="token">;</span></code></pre></div></div></pre>

* 返回 `true` 表示 **a 应该排在 b 前面**
* 必须是**严格弱序（strict weak ordering）**，否则行为未定义

> ⚠️ 错误示例：`return a <= b;` → 不是严格弱序（相等时返回 true 会导致崩溃！）


## 四、可运行完整代码示例

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">编辑</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><iostream></span><span>
</span><span></span><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><vector></span><span>
</span><span></span><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><algorithm></span><span>
</span><span></span><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><functional></span><span class="token macro"> </span><span class="token macro">// for std::greater</span><span>
</span><span></span><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><string></span><span>
</span>
<span></span><span class="token">// 自定义结构体</span><span>
</span><span></span><span class="token">struct</span><span> </span><span class="token">Person</span><span> </span><span class="token">{</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>string name</span><span class="token">;</span><span>
</span><span>    </span><span class="token">int</span><span> age</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// 重载 << 便于打印</span><span>
</span><span>    </span><span class="token">friend</span><span> std</span><span class="token double-colon">::</span><span>ostream</span><span class="token">&</span><span> </span><span class="token">operator</span><span class="token"><<</span><span class="token">(</span><span>std</span><span class="token double-colon">::</span><span>ostream</span><span class="token">&</span><span> os</span><span class="token">,</span><span> </span><span class="token">const</span><span> Person</span><span class="token">&</span><span> p</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        </span><span class="token">return</span><span> os </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>name </span><span class="token"><<</span><span> </span><span class="token">" ("</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>age </span><span class="token"><<</span><span> </span><span class="token">")"</span><span class="token">;</span><span>
</span><span>    </span><span class="token">}</span><span>
</span><span></span><span class="token">}</span><span class="token">;</span><span>
</span>
<span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"=== C++ std::sort 演示 ===\n\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    </span><span class="token">// 1. 整数默认升序排序</span><span>
</span><span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>vector</span><span class="token"><</span><span class="token">int</span><span class="token">></span><span> nums </span><span class="token">=</span><span> </span><span class="token">{</span><span class="token">5</span><span class="token">,</span><span> </span><span class="token">2</span><span class="token">,</span><span> </span><span class="token">8</span><span class="token">,</span><span> </span><span class="token">1</span><span class="token">,</span><span> </span><span class="token">9</span><span class="token">,</span><span> </span><span class="token">3</span><span class="token">}</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"原始数组: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> nums</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>nums</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> nums</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">)</span><span class="token">;</span><span> </span><span class="token">// 默认升序</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"升序排序: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> nums</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    </span><span class="token">// 2. 使用 std::greater 降序</span><span>
</span><span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>nums</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> nums</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> std</span><span class="token double-colon">::</span><span class="token generic-function">greater</span><span class="token generic-function generic"><</span><span class="token generic-function generic">int</span><span class="token generic-function generic">></span><span class="token">(</span><span class="token">)</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"降序排序: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> nums</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    </span><span class="token">// 3. Lambda 自定义排序：按绝对值升序</span><span>
</span><span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>vector</span><span class="token"><</span><span class="token">int</span><span class="token">></span><span> mixed </span><span class="token">=</span><span> </span><span class="token">{</span><span class="token">-</span><span class="token">3</span><span class="token">,</span><span> </span><span class="token">4</span><span class="token">,</span><span> </span><span class="token">-</span><span class="token">1</span><span class="token">,</span><span> </span><span class="token">2</span><span class="token">,</span><span> </span><span class="token">-</span><span class="token">5</span><span class="token">}</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"混合数组: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> mixed</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>mixed</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> mixed</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> </span><span class="token">[</span><span class="token">]</span><span class="token">(</span><span class="token">int</span><span> a</span><span class="token">,</span><span> </span><span class="token">int</span><span> b</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        </span><span class="token">return</span><span> std</span><span class="token double-colon">::</span><span class="token">abs</span><span class="token">(</span><span>a</span><span class="token">)</span><span> </span><span class="token"><</span><span> std</span><span class="token double-colon">::</span><span class="token">abs</span><span class="token">(</span><span>b</span><span class="token">)</span><span class="token">;</span><span> </span><span class="token">// 绝对值小的在前</span><span>
</span><span>    </span><span class="token">}</span><span class="token">)</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"按绝对值排序: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> mixed</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    </span><span class="token">// 4. 特殊规则：把数字 1 放到最后</span><span>
</span><span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>vector</span><span class="token"><</span><span class="token">int</span><span class="token">></span><span> special </span><span class="token">=</span><span> </span><span class="token">{</span><span class="token">3</span><span class="token">,</span><span> </span><span class="token">1</span><span class="token">,</span><span> </span><span class="token">4</span><span class="token">,</span><span> </span><span class="token">1</span><span class="token">,</span><span> </span><span class="token">5</span><span class="token">,</span><span> </span><span class="token">9</span><span class="token">,</span><span> </span><span class="token">2</span><span class="token">,</span><span> </span><span class="token">6</span><span class="token">,</span><span> </span><span class="token">1</span><span class="token">}</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"特殊数组: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> special</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>special</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> special</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> </span><span class="token">[</span><span class="token">]</span><span class="token">(</span><span class="token">int</span><span> a</span><span class="token">,</span><span> </span><span class="token">int</span><span> b</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        </span><span class="token">if</span><span> </span><span class="token">(</span><span>a </span><span class="token">==</span><span> </span><span class="token">1</span><span class="token">)</span><span> </span><span class="token">return</span><span> </span><span class="token">false</span><span class="token">;</span><span> </span><span class="token">// a 是 1，则不能放前面 → 放后面</span><span>
</span><span>        </span><span class="token">if</span><span> </span><span class="token">(</span><span>b </span><span class="token">==</span><span> </span><span class="token">1</span><span class="token">)</span><span> </span><span class="token">return</span><span> </span><span class="token">true</span><span class="token">;</span><span>  </span><span class="token">// b 是 1，则 a 应该放前面</span><span>
</span><span>        </span><span class="token">return</span><span> a </span><span class="token"><</span><span> b</span><span class="token">;</span><span>             </span><span class="token">// 其他情况正常升序</span><span>
</span><span>    </span><span class="token">}</span><span class="token">)</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"1 放最后: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> x </span><span class="token">:</span><span> special</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> x </span><span class="token"><<</span><span> </span><span class="token">" "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    </span><span class="token">// 5. 排序自定义对象（Person）</span><span>
</span><span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>vector</span><span class="token"><</span><span>Person</span><span class="token">></span><span> people </span><span class="token">=</span><span> </span><span class="token">{</span><span>
</span><span>        </span><span class="token">{</span><span class="token">"Alice"</span><span class="token">,</span><span> </span><span class="token">30</span><span class="token">}</span><span class="token">,</span><span>
</span><span>        </span><span class="token">{</span><span class="token">"Bob"</span><span class="token">,</span><span> </span><span class="token">25</span><span class="token">}</span><span class="token">,</span><span>
</span><span>        </span><span class="token">{</span><span class="token">"Charlie"</span><span class="token">,</span><span> </span><span class="token">35</span><span class="token">}</span><span class="token">,</span><span>
</span><span>        </span><span class="token">{</span><span class="token">"Diana"</span><span class="token">,</span><span> </span><span class="token">25</span><span class="token">}</span><span>
</span><span>    </span><span class="token">}</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"原始人员列表:\n"</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">const</span><span> </span><span class="token">auto</span><span class="token">&</span><span> p </span><span class="token">:</span><span> people</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"  "</span><span> </span><span class="token"><<</span><span> p </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// 按年龄升序，同龄按名字字典序</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>people</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> people</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> </span><span class="token">[</span><span class="token">]</span><span class="token">(</span><span class="token">const</span><span> Person</span><span class="token">&</span><span> a</span><span class="token">,</span><span> </span><span class="token">const</span><span> Person</span><span class="token">&</span><span> b</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        </span><span class="token">if</span><span> </span><span class="token">(</span><span>a</span><span class="token">.</span><span>age </span><span class="token">!=</span><span> b</span><span class="token">.</span><span>age</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>            </span><span class="token">return</span><span> a</span><span class="token">.</span><span>age </span><span class="token"><</span><span> b</span><span class="token">.</span><span>age</span><span class="token">;</span><span>
</span><span>        </span><span class="token">}</span><span>
</span><span>        </span><span class="token">return</span><span> a</span><span class="token">.</span><span>name </span><span class="token"><</span><span> b</span><span class="token">.</span><span>name</span><span class="token">;</span><span>
</span><span>    </span><span class="token">}</span><span class="token">)</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n按年龄+姓名排序:\n"</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">const</span><span> </span><span class="token">auto</span><span class="token">&</span><span> p </span><span class="token">:</span><span> people</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"  "</span><span> </span><span class="token"><<</span><span> p </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    </span><span class="token">// 6. 稳定排序演示（保留相等元素原顺序）</span><span>
</span><span>    </span><span class="token">// -----------------------------</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>vector</span><span class="token"><</span><span>std</span><span class="token double-colon">::</span><span>pair</span><span class="token"><</span><span class="token">int</span><span class="token">,</span><span> </span><span class="token">char</span><span class="token">>></span><span> data </span><span class="token">=</span><span> </span><span class="token">{</span><span>
</span><span>        </span><span class="token">{</span><span class="token">2</span><span class="token">,</span><span> </span><span class="token char">'a'</span><span class="token">}</span><span class="token">,</span><span> </span><span class="token">{</span><span class="token">1</span><span class="token">,</span><span> </span><span class="token char">'b'</span><span class="token">}</span><span class="token">,</span><span> </span><span class="token">{</span><span class="token">2</span><span class="token">,</span><span> </span><span class="token char">'c'</span><span class="token">}</span><span class="token">,</span><span> </span><span class="token">{</span><span class="token">1</span><span class="token">,</span><span> </span><span class="token char">'d'</span><span class="token">}</span><span>
</span><span>    </span><span class="token">}</span><span class="token">;</span><span>
</span>
<span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"原始配对数据: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">auto</span><span> p </span><span class="token">:</span><span> data</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"("</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>first </span><span class="token"><<</span><span> </span><span class="token">","</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>second </span><span class="token"><<</span><span> </span><span class="token">") "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// 普通 sort（不稳定）</span><span>
</span><span>    </span><span class="token">auto</span><span> unstable </span><span class="token">=</span><span> data</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span class="token">sort</span><span class="token">(</span><span>unstable</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> unstable</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span>
</span><span>              </span><span class="token">[</span><span class="token">]</span><span class="token">(</span><span class="token">const</span><span> </span><span class="token">auto</span><span class="token">&</span><span> x</span><span class="token">,</span><span> </span><span class="token">const</span><span> </span><span class="token">auto</span><span class="token">&</span><span> y</span><span class="token">)</span><span> </span><span class="token">{</span><span> </span><span class="token">return</span><span> x</span><span class="token">.</span><span>first </span><span class="token"><</span><span> y</span><span class="token">.</span><span>first</span><span class="token">;</span><span> </span><span class="token">}</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"std::sort 结果: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">auto</span><span> p </span><span class="token">:</span><span> unstable</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"("</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>first </span><span class="token"><<</span><span> </span><span class="token">","</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>second </span><span class="token"><<</span><span> </span><span class="token">") "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// stable_sort（稳定）</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span class="token">stable_sort</span><span class="token">(</span><span>data</span><span class="token">.</span><span class="token">begin</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span> data</span><span class="token">.</span><span class="token">end</span><span class="token">(</span><span class="token">)</span><span class="token">,</span><span>
</span><span>                     </span><span class="token">[</span><span class="token">]</span><span class="token">(</span><span class="token">const</span><span> </span><span class="token">auto</span><span class="token">&</span><span> x</span><span class="token">,</span><span> </span><span class="token">const</span><span> </span><span class="token">auto</span><span class="token">&</span><span> y</span><span class="token">)</span><span> </span><span class="token">{</span><span> </span><span class="token">return</span><span> x</span><span class="token">.</span><span>first </span><span class="token"><</span><span> y</span><span class="token">.</span><span>first</span><span class="token">;</span><span> </span><span class="token">}</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"std::stable_sort 结果: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">auto</span><span> p </span><span class="token">:</span><span> data</span><span class="token">)</span><span> std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"("</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>first </span><span class="token"><<</span><span> </span><span class="token">","</span><span> </span><span class="token"><<</span><span> p</span><span class="token">.</span><span>second </span><span class="token"><<</span><span> </span><span class="token">") "</span><span class="token">;</span><span>
</span><span>    std</span><span class="token double-colon">::</span><span>cout </span><span class="token"><<</span><span> </span><span class="token">"\n"</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">return</span><span> </span><span class="token">0</span><span class="token">;</span><span>
</span><span></span><span class="token">}</span></code></pre></div></div></pre>


## 七、最佳实践建议


| 场景           | 推荐做法                                           |
| -------------- | -------------------------------------------------- |
| 默认排序       | `std::sort(v.begin(), v.end())`                    |
| 降序           | `std::sort(v.begin(), v.end(), std::greater<T>())` |
| 自定义规则     | 使用 **lambda 表达式**（简洁清晰）                 |
| 相等元素需保序 | 使用`std::stable_sort`                             |
| 性能敏感       | 避免在 lambda 中做昂贵操作（如函数调用）           |
| 复杂对象       | 考虑重载`operator<` 或提供命名函数对象             |


## 八、常见陷阱


| 错误                   | 正确做法                                         |
| ---------------------- | ------------------------------------------------ |
| `return a <= b;`       | `return a < b;`                                  |
| 比较函数有副作用       | 比较函数必须是纯函数（无副作用）                 |
| 修改容器中元素         | 排序期间不要修改被排序的元素                     |
| 对非随机访问迭代器使用 | `std::sort` 只支持 `vector`, `array`, 原生数组等 |


## 九、扩展：其他排序算法


| 函数                | 用途                  |
| ------------------- | --------------------- |
| `std::partial_sort` | 只对前 k 个元素排序   |
| `std::nth_element`  | 找第 k 小元素，并分区 |
| `std::is_sorted`    | 检查是否已排序        |
| `std::sort_heap`    | 对堆结构排序          |


## 十、总结


| 特性     | 说明                                                   |
| -------- | ------------------------------------------------------ |
| **高效** | O(n log n)，工业级优化                                 |
| **灵活** | 支持任意类型 + 自定义规则                              |
| **安全** | 类型安全，避免手写错误                                 |
| **现代** | 配合 lambda，代码简洁优雅                              |
| **推荐** | **永远优先使用 `std::sort`，而不是自己实现排序算法！** |
