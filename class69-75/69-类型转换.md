# C++ ç±»å‹è½¬æ¢ï¼ˆcastingï¼‰

åœ¨ C++ ä¸­ï¼Œç±»å‹è½¬æ¢ï¼ˆcastingï¼‰æ˜¯å°†ä¸€ç§æ•°æ®ç±»å‹æ˜¾å¼æˆ–éšå¼åœ°è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹çš„è¿‡ç¨‹ã€‚C++ æ˜¯ä¸€é—¨å¼ºç±»å‹è¯­è¨€ï¼Œå› æ­¤å¯¹ç±»å‹è½¬æ¢æœ‰ä¸¥æ ¼çš„æ§åˆ¶ã€‚ä¸ºäº†æé«˜ä»£ç çš„å®‰å…¨æ€§å’Œå¯è¯»æ€§ï¼ŒC++ æä¾›äº†å››ç§ **å‘½åçš„ç±»å‹è½¬æ¢æ“ä½œç¬¦**ï¼ˆnamed cast operatorsï¼‰ï¼Œå–ä»£ä¼ ç»Ÿçš„ C é£æ ¼å¼ºåˆ¶è½¬æ¢ã€‚

## ä¸€ã€C++ ç±»å‹è½¬æ¢æ¦‚è¿°

C++ æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œå˜é‡ä¸€æ—¦å£°æ˜ä¸ºæŸç§ç±»å‹ï¼Œå°±ä¸èƒ½éšæ„å½“ä½œå…¶ä»–ç±»å‹ä½¿ç”¨ã€‚ä½†æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨ä¸åŒç±»å‹ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œè¿™æ—¶å°±éœ€è¦ **ç±»å‹è½¬æ¢ï¼ˆcastingï¼‰**ã€‚

C++ æä¾›äº† **å››ç§æ˜¾å¼ç±»å‹è½¬æ¢æ“ä½œç¬¦**ï¼Œç›¸æ¯” C é£æ ¼çš„ `(type)expr` æ›´å®‰å…¨ã€æ›´æ¸…æ™°ï¼š


| è½¬æ¢æ“ä½œç¬¦         | ç”¨é€”è¯´æ˜                                                                            |
| ------------------ | ----------------------------------------------------------------------------------- |
| `static_cast`      | ç¼–è¯‘æ—¶æ£€æŸ¥çš„å¸¸è§„ç±»å‹è½¬æ¢ï¼ˆå¦‚æ•°å€¼ç±»å‹ä¹‹é—´ã€ç»§æ‰¿ç±»æŒ‡é’ˆå‘ä¸Š/å‘ä¸‹è½¬æ¢ï¼ˆæ— è¿è¡Œæ—¶æ£€æŸ¥ï¼‰ï¼‰ |
| `dynamic_cast`     | å®‰å…¨åœ°è¿›è¡Œ**å¤šæ€ç±»å‹**çš„å‘ä¸‹è½¬æ¢ï¼ˆéœ€è™šå‡½æ•°ï¼Œè¿è¡Œæ—¶æ£€æŸ¥ï¼‰                            |
| `const_cast`       | æ·»åŠ æˆ–ç§»é™¤`const` / `volatile` é™å®šç¬¦                                               |
| `reinterpret_cast` | ä½çº§é‡æ–°è§£é‡Šä½æ¨¡å¼ï¼ˆå±é™©ï¼Œç”¨äºåº•å±‚ç¼–ç¨‹ï¼‰                                            |

> âš ï¸ å°½é‡é¿å…ä½¿ç”¨ C é£æ ¼è½¬æ¢ `(int)x`ï¼Œå› ä¸ºå®ƒè¡Œä¸ºä¸æ˜ç¡®ï¼ˆå¯èƒ½ç­‰ä»·äºä¸Šè¿°ä»»æ„ä¸€ç§ï¼‰ï¼Œä¸”æ— æ³•è¢«é™æ€åˆ†æå·¥å…·è¯†åˆ«ã€‚
>


## äºŒã€å„ç±»å‹è½¬æ¢è¯¦è§£ + å¯è¿è¡Œä»£ç 

### 1. `static_cast`

* ç”¨äºç›¸å…³ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼ˆå¦‚ `int â†” double`ã€åŸºç±» â†” æ´¾ç”Ÿç±»æŒ‡é’ˆï¼ˆä½†ä¸å®‰å…¨ï¼ï¼‰ï¼‰
* **ç¼–è¯‘æ—¶æ£€æŸ¥**ï¼Œä¸ç”Ÿæˆé¢å¤–è¿è¡Œæ—¶å¼€é”€
* **ä¸èƒ½ç”¨äºå»é™¤ const**

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">ç¼–è¾‘</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><iostream></span><span>
</span><span></span><span class="token">using</span><span> </span><span class="token">namespace</span><span> std</span><span class="token">;</span><span>
</span>
<span></span><span class="token">class</span><span> </span><span class="token">Base</span><span> </span><span class="token">{</span><span class="token">}</span><span class="token">;</span><span>
</span><span></span><span class="token">class</span><span> </span><span class="token">Derived</span><span> </span><span class="token">:</span><span> </span><span class="token base-clause">public</span><span class="token base-clause"> </span><span class="token base-clause">Base</span><span> </span><span class="token">{</span><span class="token">}</span><span class="token">;</span><span>
</span>
<span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>    </span><span class="token">// æ•°å€¼ç±»å‹è½¬æ¢</span><span>
</span><span>    </span><span class="token">double</span><span> d </span><span class="token">=</span><span> </span><span class="token">5.7</span><span class="token">;</span><span>
</span><span>    </span><span class="token">int</span><span> i </span><span class="token">=</span><span> </span><span class="token generic-function">static_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">int</span><span class="token generic-function generic">></span><span class="token">(</span><span>d</span><span class="token">)</span><span class="token">;</span><span> </span><span class="token">// i = 5</span><span>
</span><span>    cout </span><span class="token"><<</span><span> </span><span class="token">"static_cast<double->int>: "</span><span> </span><span class="token"><<</span><span> i </span><span class="token"><<</span><span> endl</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// æŒ‡é’ˆå‘ä¸Šè½¬æ¢ï¼ˆå®‰å…¨ï¼‰</span><span>
</span><span>    Derived</span><span class="token">*</span><span> d_ptr </span><span class="token">=</span><span> </span><span class="token">new</span><span> </span><span class="token">Derived</span><span class="token">(</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    Base</span><span class="token">*</span><span> b_ptr </span><span class="token">=</span><span> </span><span class="token generic-function">static_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">Base</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span>d_ptr</span><span class="token">)</span><span class="token">;</span><span> </span><span class="token">// å‘ä¸Šè½¬æ¢ï¼Œæ€»æ˜¯å®‰å…¨</span><span>
</span>
<span>    </span><span class="token">// æŒ‡é’ˆå‘ä¸‹è½¬æ¢ï¼ˆä¸å®‰å…¨ï¼æ— è¿è¡Œæ—¶æ£€æŸ¥ï¼‰</span><span>
</span><span>    Base</span><span class="token">*</span><span> base </span><span class="token">=</span><span> </span><span class="token">new</span><span> </span><span class="token">Base</span><span class="token">(</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    Derived</span><span class="token">*</span><span> derived </span><span class="token">=</span><span> </span><span class="token generic-function">static_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">Derived</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span>base</span><span class="token">)</span><span class="token">;</span><span> </span><span class="token">// å±é™©ï¼ä½†ç¼–è¯‘é€šè¿‡</span><span>
</span><span>    </span><span class="token">// ä½¿ç”¨ derived å¯èƒ½å¯¼è‡´æœªå®šä¹‰è¡Œä¸º</span><span>
</span>
<span>    </span><span class="token">delete</span><span> d_ptr</span><span class="token">;</span><span>
</span><span>    </span><span class="token">delete</span><span> base</span><span class="token">;</span><span>
</span><span>    </span><span class="token">return</span><span> </span><span class="token">0</span><span class="token">;</span><span>
</span><span></span><span class="token">}</span></code></pre></div></div></pre>

---

### 2. `dynamic_cast`

* **ä»…ç”¨äºå¤šæ€ç±»å‹**ï¼ˆç±»ä¸­è‡³å°‘æœ‰ä¸€ä¸ªè™šå‡½æ•°ï¼‰
* **è¿è¡Œæ—¶æ£€æŸ¥**ï¼ˆä¾èµ– RTTIï¼‰
* è‹¥è½¬æ¢å¤±è´¥ï¼š
  * æŒ‡é’ˆç±»å‹ â†’ è¿”å› `nullptr`
  * å¼•ç”¨ç±»å‹ â†’ æŠ›å‡º `std::bad_cast`

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">ç¼–è¾‘</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><iostream></span><span>
</span><span></span><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><typeinfo></span><span>
</span><span></span><span class="token">using</span><span> </span><span class="token">namespace</span><span> std</span><span class="token">;</span><span>
</span>
<span></span><span class="token">class</span><span> </span><span class="token">Base</span><span> </span><span class="token">{</span><span>
</span><span></span><span class="token">public</span><span class="token">:</span><span>
</span><span>    </span><span class="token">virtual</span><span> </span><span class="token">~</span><span class="token">Base</span><span class="token">(</span><span class="token">)</span><span> </span><span class="token">{</span><span class="token">}</span><span> </span><span class="token">// å¿…é¡»æœ‰è™šå‡½æ•°ï¼</span><span>
</span><span></span><span class="token">}</span><span class="token">;</span><span>
</span>
<span></span><span class="token">class</span><span> </span><span class="token">Derived</span><span> </span><span class="token">:</span><span> </span><span class="token base-clause">public</span><span class="token base-clause"> </span><span class="token base-clause">Base</span><span> </span><span class="token">{</span><span class="token">}</span><span class="token">;</span><span>
</span><span></span><span class="token">class</span><span> </span><span class="token">Another</span><span> </span><span class="token">:</span><span> </span><span class="token base-clause">public</span><span class="token base-clause"> </span><span class="token base-clause">Base</span><span> </span><span class="token">{</span><span class="token">}</span><span class="token">;</span><span>
</span>
<span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>    Base</span><span class="token">*</span><span> base </span><span class="token">=</span><span> </span><span class="token">new</span><span> </span><span class="token">Derived</span><span class="token">(</span><span class="token">)</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// æˆåŠŸè½¬æ¢</span><span>
</span><span>    Derived</span><span class="token">*</span><span> d </span><span class="token">=</span><span> </span><span class="token generic-function">dynamic_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">Derived</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span>base</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    </span><span class="token">if</span><span> </span><span class="token">(</span><span>d</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        cout </span><span class="token"><<</span><span> </span><span class="token">"dynamic_cast to Derived: success"</span><span> </span><span class="token"><<</span><span> endl</span><span class="token">;</span><span>
</span><span>    </span><span class="token">}</span><span>
</span>
<span>    </span><span class="token">// å¤±è´¥è½¬æ¢</span><span>
</span><span>    Another</span><span class="token">*</span><span> a </span><span class="token">=</span><span> </span><span class="token generic-function">dynamic_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">Another</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span>base</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    </span><span class="token">if</span><span> </span><span class="token">(</span><span class="token">!</span><span>a</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        cout </span><span class="token"><<</span><span> </span><span class="token">"dynamic_cast to Another: failed (returns nullptr)"</span><span> </span><span class="token"><<</span><span> endl</span><span class="token">;</span><span>
</span><span>    </span><span class="token">}</span><span>
</span>
<span>    </span><span class="token">delete</span><span> base</span><span class="token">;</span><span>
</span><span>    </span><span class="token">return</span><span> </span><span class="token">0</span><span class="token">;</span><span>
</span><span></span><span class="token">}</span></code></pre></div></div></pre>

> âœ… è¾“å‡ºï¼š
>
> <pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">text</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">ç¼–è¾‘</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span>dynamic_cast to Derived: success
> </span>dynamic_cast to Another: failed (returns nullptr)</code></pre></div></div></pre>

---

### 3. `const_cast`

* å”¯ä¸€èƒ½ä¿®æ”¹ `const` / `volatile` å±æ€§çš„è½¬æ¢
* **ä¸èƒ½ç”¨äºæ”¹å˜é const å¯¹è±¡çš„å¸¸é‡æ€§æ¥å†™å…¥åŸå§‹ const å¯¹è±¡**ï¼ˆUBï¼‰

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">ç¼–è¾‘</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><iostream></span><span>
</span><span></span><span class="token">using</span><span> </span><span class="token">namespace</span><span> std</span><span class="token">;</span><span>
</span>
<span></span><span class="token">void</span><span> </span><span class="token">print</span><span class="token">(</span><span class="token">char</span><span class="token">*</span><span> str</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>    cout </span><span class="token"><<</span><span> str </span><span class="token"><<</span><span> endl</span><span class="token">;</span><span>
</span><span></span><span class="token">}</span><span>
</span>
<span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>    </span><span class="token">const</span><span> </span><span class="token">char</span><span class="token">*</span><span> cstr </span><span class="token">=</span><span> </span><span class="token">"Hello"</span><span class="token">;</span><span>
</span><span>    </span><span class="token">// print(cstr); // é”™è¯¯ï¼šä¸èƒ½å°† const char* è½¬ä¸º char*</span><span>
</span>  
<span>    </span><span class="token">char</span><span class="token">*</span><span> mutable_str </span><span class="token">=</span><span> </span><span class="token generic-function">const_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">char</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span>cstr</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    </span><span class="token">print</span><span class="token">(</span><span>mutable_str</span><span class="token">)</span><span class="token">;</span><span> </span><span class="token">// æŠ€æœ¯ä¸Šå¯è¡Œï¼Œä½†è‹¥å°è¯•ä¿®æ”¹å­—ç¬¦ä¸²å­—é¢é‡ â†’ æœªå®šä¹‰è¡Œä¸ºï¼</span><span>
</span>
<span>    </span><span class="token">// å®‰å…¨ç”¨æ³•ï¼šå¯¹è±¡æœ¬èº«ä¸æ˜¯ const</span><span>
</span><span>    </span><span class="token">char</span><span> data</span><span class="token">[</span><span class="token">]</span><span> </span><span class="token">=</span><span> </span><span class="token">"World"</span><span class="token">;</span><span> </span><span class="token">// æ ˆä¸Šæ•°ç»„ï¼Œå¯ä¿®æ”¹</span><span>
</span><span>    </span><span class="token">const</span><span> </span><span class="token">char</span><span class="token">*</span><span> p </span><span class="token">=</span><span> data</span><span class="token">;</span><span>
</span><span>    </span><span class="token">char</span><span class="token">*</span><span> q </span><span class="token">=</span><span> </span><span class="token generic-function">const_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">char</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span>p</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    q</span><span class="token">[</span><span class="token">0</span><span class="token">]</span><span> </span><span class="token">=</span><span> </span><span class="token char">'w'</span><span class="token">;</span><span> </span><span class="token">// OK!</span><span>
</span><span>    cout </span><span class="token"><<</span><span> q </span><span class="token"><<</span><span> endl</span><span class="token">;</span><span> </span><span class="token">// "world"</span><span>
</span>
<span>    </span><span class="token">return</span><span> </span><span class="token">0</span><span class="token">;</span><span>
</span><span></span><span class="token">}</span></code></pre></div></div></pre>

---

### 4. `reinterpret_cast`

* **ç›´æ¥é‡æ–°è§£é‡Šä½æ¨¡å¼**ï¼Œæå…¶å±é™©
* å¸¸ç”¨äºåº•å±‚æ“ä½œï¼ˆå¦‚ç¡¬ä»¶å¯„å­˜å™¨ã€ç½‘ç»œåè®®è§£æï¼‰

<pre><div class="contain-layout-style rounded-12 bg-capsule relative flex min-h-[2em] flex-col"><div class="rounded-[12px] bg-[#fff]"><div class="h-[36px] sticky top-0 z-10 bg-primary"><div class="flex items-center h-[36px] px-3 text-12 align-middle border border-[var(--ty-line-border)]"><span class="font-medium mr-auto first-letter:uppercase text-12 text-[rgba(17,17,51,0.7)]">cpp</span><div class="flex items-center gap-4"><div class="flex items-center justify-center gap-[2px] cursor-pointer text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4 cursor-pointer"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-editingTools-line"></use></svg></span><span class="mt-[2px] text-[12px]">ç¼–è¾‘</span></div><span role="img" tabindex="-1" class="anticon flex cursor-pointer items-center text-16 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-copy-line"></use></svg></span><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-moon-line"></use></svg></span></div><div class="flex cursor-pointer gap-1 text-[rgba(17,17,51,0.7)] hover:text-[#4433ff]"><span role="img" class="anticon text-16 size-4"><svg width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false" class=""><use xlink:href="#pcicon-up-line"></use></svg></span></div></div></div></div><pre class="sc-bRKDuR jCSJQZ"><code><span class="token macro directive-hash">#</span><span class="token macro">include</span><span class="token macro"> </span><span class="token macro"><iostream></span><span>
</span><span></span><span class="token">using</span><span> </span><span class="token">namespace</span><span> std</span><span class="token">;</span><span>
</span>
<span></span><span class="token">int</span><span> </span><span class="token">main</span><span class="token">(</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>    </span><span class="token">int</span><span> x </span><span class="token">=</span><span> </span><span class="token">0x41424344</span><span class="token">;</span><span> </span><span class="token">// ASCII: ABCD</span><span>
</span><span>    </span><span class="token">char</span><span class="token">*</span><span> p </span><span class="token">=</span><span> </span><span class="token generic-function">reinterpret_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">char</span><span class="token generic-function generic">*</span><span class="token generic-function generic">></span><span class="token">(</span><span class="token">&</span><span>x</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    cout </span><span class="token"><<</span><span> </span><span class="token">"Reinterpreted as chars: "</span><span class="token">;</span><span>
</span><span>    </span><span class="token">for</span><span> </span><span class="token">(</span><span class="token">int</span><span> i </span><span class="token">=</span><span> </span><span class="token">0</span><span class="token">;</span><span> i </span><span class="token"><</span><span> </span><span class="token">4</span><span class="token">;</span><span> </span><span class="token">++</span><span>i</span><span class="token">)</span><span> </span><span class="token">{</span><span>
</span><span>        cout </span><span class="token"><<</span><span> p</span><span class="token">[</span><span>i</span><span class="token">]</span><span class="token">;</span><span>
</span><span>    </span><span class="token">}</span><span>
</span><span>    cout </span><span class="token"><<</span><span> endl</span><span class="token">;</span><span>
</span>
<span>    </span><span class="token">// å‡½æ•°æŒ‡é’ˆè½¬æ¢ï¼ˆç½•è§ä½†åˆæ³•ï¼‰</span><span>
</span><span>    </span><span class="token">void</span><span> </span><span class="token">(</span><span class="token">*</span><span>func</span><span class="token">)</span><span class="token">(</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    </span><span class="token">long</span><span> addr </span><span class="token">=</span><span> </span><span class="token generic-function">reinterpret_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">long</span><span class="token generic-function generic">></span><span class="token">(</span><span class="token">&</span><span>main</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    func </span><span class="token">=</span><span> </span><span class="token generic-function">reinterpret_cast</span><span class="token generic-function generic"><</span><span class="token generic-function generic">void</span><span class="token generic-function generic">(</span><span class="token generic-function generic">*</span><span class="token generic-function generic">)</span><span class="token generic-function generic">(</span><span class="token generic-function generic">)</span><span class="token generic-function generic">></span><span class="token">(</span><span>addr</span><span class="token">)</span><span class="token">;</span><span>
</span><span>    </span><span class="token">// func(); // ä¸å»ºè®®è°ƒç”¨ï¼Œä»…æ¼”ç¤º</span><span>
</span>
<span>    </span><span class="token">return</span><span> </span><span class="token">0</span><span class="token">;</span><span>
</span><span></span><span class="token">}</span></code></pre></div></div></pre>

> ğŸ’¡ æ³¨æ„ï¼šè¾“å‡ºå¯èƒ½å› å­—èŠ‚åºï¼ˆendiannessï¼‰ä¸åŒè€Œå¼‚ï¼ˆå°ç«¯æœºå™¨é€šå¸¸è¾“å‡º `DCBA`ï¼‰



## ä¸‰ã€æ€»ç»“å¯¹æ¯”è¡¨


| è½¬æ¢ç±»å‹           | å®‰å…¨æ€§ | æ£€æŸ¥æ—¶æœº | å…¸å‹ç”¨é€”                       |
| ------------------ | ------ | -------- | ------------------------------ |
| `static_cast`      | ä¸­     | ç¼–è¯‘æ—¶   | æ•°å€¼è½¬æ¢ã€ç±»å±‚æ¬¡è½¬æ¢ï¼ˆéœ€è°¨æ…ï¼‰ |
| `dynamic_cast`     | é«˜     | è¿è¡Œæ—¶   | å¤šæ€ç±»å®‰å…¨å‘ä¸‹è½¬æ¢             |
| `const_cast`       | ä½     | æ—        | å»é™¤/æ·»åŠ  constï¼ˆæ…ç”¨ï¼‰        |
| `reinterpret_cast` | æä½   | æ—        | ä½æ¨¡å¼é‡è§£é‡Šï¼ˆåº•å±‚ï¼‰           |
| C é£æ ¼`(T)x`       | æœ€ä½   | æ··åˆ     | **åº”é¿å…**                     |


## å››ã€æœ€ä½³å®è·µå»ºè®®

1. **ä¼˜å…ˆä½¿ç”¨ `static_cast`** è¿›è¡Œå¸¸è§„è½¬æ¢ã€‚
2. **å¤šæ€ç±»å‘ä¸‹è½¬æ¢ç”¨ `dynamic_cast`**ï¼Œå¹¶æ£€æŸ¥è¿”å›å€¼ã€‚
3. **å°½é‡é¿å… `const_cast` å’Œ `reinterpret_cast`**ï¼Œé™¤éå¿…è¦ï¼ˆå¦‚å¯¹æ¥ C API æˆ–ç³»ç»Ÿç¼–ç¨‹ï¼‰ã€‚
4. **æ°¸è¿œä¸è¦ç”¨ C é£æ ¼è½¬æ¢** â€”â€” å®ƒéšè—äº†æ„å›¾ï¼Œéš¾ä»¥ç»´æŠ¤å’Œè°ƒè¯•ã€‚
